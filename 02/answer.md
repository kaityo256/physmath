# 第二回 微分方程式の解法

## 目的

変数分離法、定数変化法など、代表的な線形偏微分方程式の解法を学ぶ。特に、線形性について学び、変数分離法により微分方程式が固有値問題となることを理解する。

## 解答

### 6. (1)

$$
\frac{\mathrm{d} y}{\mathrm{d} x} = \frac{\ln x}{y} 
$$

変数分離型であるから、$y$を左辺に移項して$x$で積分すればよい。$y$の積分は問題ないであろうが、$x$の積分は$\ln x$を含むため、以下のように部分積分が必要となる。

$$
\begin{aligned}
\int \ln x \mathrm{d}x
&= \int (x)'\ln x \mathrm{d}x \\
&= x \ln x - \int x (\ln x)' \mathrm{d}x \\
&= x \ln x - x + C
\end{aligned}
$$

以上から、

$$
  \frac{y^2}{2} = x \ln x - x + C
$$

を得る。

### 6. (2)

$$
\frac{\mathrm{d} y}{\mathrm{d} x} + y= 2 \sin x 
$$

定数変化法を用いる。まず、$2\sin x$を無視すると

$$
  \frac{\mathrm{d} y}{\mathrm{d} x} + y= 0
$$

である。この微分方程式の一般解は

$$
  y = C \mathrm{e}^{-x}
$$

である。この事実から、もとの微分方程式の解を

$$
  y = C(x) \mathrm{e}^{-x}
$$

の形に仮定する。微分方程式に代入すると$C(x)$が満たすべき微分方程式、

$$
  \frac{\mathrm{d} C}{\mathrm{d} x} =  2 \mathrm{e}^{x} \sin(x)
$$

が求める。これは容易に積分できて、

$$
  C(x) = \mathrm{e}^x (\sin x - \cos x) + C_2
$$

となる。$C_2$は新たな積分定数である。以上から

$$
  y = \sin x - \cos x + C \mathrm{e}^{-x}
$$

と求まる(ただし積分定数$C_2$を$C$とおきなおした)。微分方程式を解く場合、解の形を仮定して代入し、より易しい方程式に落とす方法が良く取られる。この定数変化法はその一つである。

### 6. (3)

$$
\frac{\mathrm{d}^2 y}{\mathrm{d} x^2} + 3 \frac{\mathrm{d} y}{\mathrm{d} x} + 2y = 0 
$$

微分方程式が同次形であるため、問題を解くこと自体は簡単である。$y = \exp(\lambda)$の形を仮定して代入すると、$\lambda$に関する代数方程式、

$$
  \lambda^2 + 3 \lambda + 2 = 0
$$

を得る。この方程式を **特性方程式(characteristic equation)** と呼ぶ。この方程式の解は$\lambda = -1, -2$であるから、$y$は独立な解$\mathrm{e}^{-x}$及び$\mathrm{e}^{-2x}$を持つ。以上から一般解として

$$
  y = C_1 \mathrm{e}^{-x} + C_2 \mathrm{e}^{-2x}
$$

を得る。二階微分方程式であるから、独立な積分定数を二つ含むことに注意せよ。

### 7. (1)

まず、

$$
\frac{\mathrm{d}^2 y}{\mathrm{d} x^2} + 4 \frac{\mathrm{d} y}{\mathrm{d} x} + 3y = 0
$$

の一般解は、

$$
  y = C_1 \mathrm{e}^{-x} + C_2 \mathrm{e}^{-3x}
$$

である。境界条件$y(0) = 0$、$y'(0) = 1$より、
連立方程式、

$$
\begin{aligned}
  C_1 + C_2 &= 0 \\
  -C_1 -3 C_2 &= 1
\end{aligned}
$$

が求まる。この解は、$C_1 = 1/2, C_2 = - 1/2$であるので、特解は

$$
  y = \frac{1}{2}(\mathrm{e}^{-x} - \mathrm{e}^{-3x})
$$

と求まる。これは一度値が増え、その後減衰していく振る舞いを示している。

### 7. (2)

$$
  \frac{\mathrm{d}^2 y}{\mathrm{d} x^2} + 2 \frac{\mathrm{d} y}{\mathrm{d} x} + 2y = 0
$$

同様に$y = \exp(\lambda)$と仮定して特性方程式の根を求めると$\lambda = -1 \pm i$と、複素共役な根を持つことが分かる。$\lambda$が複素数であってもやることは同じで、一般解は、

$$
  y = e^{-x} \left(C_1 \mathrm{e}^{ix} + C_2 \mathrm{e}^{-ix} \right)
$$

と求まるから、$y(0) = 1$、$y'(0) = 0$より、$C_1 = (1-i)/2, C_2 = (1+i)/2$と求まる。$\mathrm{e}^{ix} = \cos x + i \sin x$に注意して解に代入して整理すると、

$$
  y = e^{-x} \left( \cos x + \sin x \right)
$$

となる。これは振動しながら減衰する減衰振動を表す。

この式でわかるように、実部が振幅の時間発展を、虚部が振動項を表している。したがって、 **実部が正であればその解は$x \rightarrow \infty$で発散する** 。これは線形安定性解析と呼ばれる解析で用いられる最も基本的な事実である。特性方程式の根の実部が正であるか負であるかは、解が安定であるか不安定であるかという事実とつながっている。

### 8. (1)

$$
 \frac{\partial u}{\partial t} =  \kappa \frac{\partial^2 u}{\partial x^2} 
$$

解の形を$u(x,t) = X(x)T(t)$と仮定して代入しよう。
すると、

$$
  X \frac{\mathrm{d} T}{\mathrm{d} t} = \kappa T \frac{\mathrm{d}^2 X}{\mathrm{d} x^2}
$$

となる。ここで **偏微分が常微分になったことに注意せよ** 。

$X(x)$、$T(t)$はそれぞれ$x$のみ、$t$のみの関数であるから、それぞれの変数による偏微分は常微分となる。
式を整理すると

$$
  \frac{1}{T} \frac{\mathrm{d} T}{\mathrm{d} t} = \kappa  \frac{1}{X} \frac{\mathrm{d}^2 X}{\mathrm{d} x^2}
$$

となる。左辺は$t$のみ、右辺は$x$のみに依存するから、
これが恒等式となるためには、それぞれ定数でなければならない。その定数を後の便利のために$\lambda$とおくと、

$$
\begin{aligned}
  \frac{\mathrm{d} T}{\mathrm{d} t} &= & \lambda T \\
  \frac{\mathrm{d}^2 X}{\mathrm{d} x^2} &= & \frac{\lambda}{\kappa} X
\end{aligned}
$$

となる。以上から、偏微分方程式が常微分方程式に
帰着された。あとは常微分方程式と同様に解けばよい。
これが偏微分方程式における変数分離法である。
なお先取りになるが、これらがそれぞれ
固有値問題になっていることに注意したい。

さて、$T(t)$、$X(x)$それぞれの解は

$$
\begin{aligned}
  T(t) &= \mathrm{e}^{\lambda t}\\
  X(t) &= \mathrm{e}^{\alpha x}, \mathrm{e}^{- \alpha x}
\end{aligned}
$$

である(ただし$\alpha \equiv \sqrt{\lambda/\kappa}$)。以上から一般解は

$$
  u(x,t) = C_1 \exp{(\lambda t + \alpha x)} + C_2 \exp{(\lambda t - \alpha x)}
$$

となる。ここで、$\lambda$や$\alpha$の次元に注意したい。すでに述べたように指数関数の肩に次元のある量が乗ってはならない。したがって、$\alpha$が長さの逆数の次元$[L^{-1}]$を、$\lambda$が時間の逆数の次元$[T^{-1}]$を持っているはずである。先ほどの式を見れば、$\lambda$が時間の逆数の次元を持っていることが分かるであろう。また、元の微分方程式から$\kappa$の次元が$[L^2 T^{-1}]$であることに注意すれば、$\alpha$が$[L^{-1}]$の次元を持つことも分かる。

### 8. (2)

境界条件として、任意の$t$において$u(0,t) = u(\pi,t) = 0$が与えられている。まず、$\lambda$の符号によって場合わけをしなくてはならない。$\lambda>0$の場合、$\alpha$は正の実数であるから、$C_1 = 0$、$C_2 = 0$でなくてはならない。すなわち、解は$u(x,t)=0$という定数関数となる。このような解を **自明な(trivial)** 解と呼び、物理的には興味が無い。

そこで$\lambda <0$の場合を考える。$\alpha \equiv \sqrt{\lambda/\kappa}$であることから、$\lambda = -\kappa k^2$と置く。すると$\alpha = i k$となることから一般解を書き直すと、

$$
  u(x,t) = \mathrm{e}^{- \kappa k^2 t}
  \left(
  C_1 \mathrm{e}^{ikx} +
  C_2 \mathrm{e}^{-ikx}
  \right)
$$

$u(0,t) = 0$より、$C_1 = - C_2$である。さらに$u(\pi,t) = 0$から、$k = n \quad (n = 1,2,\cdots)$でなければならない。

以上をまとめると、解として

$$
u(x,t) = C \mathrm{e}^{- \kappa n^2 t} \sin(nx)
$$

を得る。ただし$C_1 = - C_2 = \displaystyle\frac{C}{2i}$とした。偏微分方程式の微分の階数に比べて、条件が少ないために積分定数をすべて決められないことに注意しよう。この方程式は熱伝導方程式と呼ばれ、フーリエ級数解析の発見のきっかけとなった。得られた解は、最初に熱を持っていた棒が、両端で冷やされ、全体として冷却されていく過程を表している。またこれは、フーリエ級数展開の一例となっている。フーリエは熱伝導の問題を解くためにフーリエ級数展開を考案したのである。

### 9. (1)

定義により、$u_1$、$u_2$が方程式の
解であるとき、$au_1 + bu_2$が方程式の解となるか
確かめればよい。
$u_1$、$u_2$が方程式の解であるから、それぞれ

$$
\begin{aligned}
  \frac{\partial u_1}{\partial t} +  \frac{\partial^3 u_1}{\partial x^3} + 6  \frac{\partial u_1}{\partial x}  &= 0\\
  \frac{\partial u_2}{\partial t} +  \frac{\partial^3 u_2}{\partial x^3} + 6  \frac{\partial u_2}{\partial x}  &= 0
\end{aligned}
$$

を満たす。それぞれ$a$倍、$b$倍して辺々足せば、

$$
  \frac{\partial (au_1+bu_2)}{\partial t} +  \frac{\partial^3 (au_1+bu_2)}{\partial x^3} + 6  \frac{\partial (au_1+bu_2)}{\partial x}  = 0
$$

から、$au_1+bu_2$も解となっていることが分かる。
これは、微分演算子が線形であるからである。

### 9. (2)

$u$を解として、$c$倍した解$cu$が解であるか確かめよう。代入すると、

$$
\begin{aligned}
  c \frac{\partial u}{\partial t} +  c\frac{\partial^3 u_1}{\partial x^3} + 6 c^2 u\frac{\partial u_1}{\partial x}  &=
  c \underbrace{\left( \frac{\partial u}{\partial t} +  \frac{\partial^3 u_1}{\partial x^3} + 6 u \frac{\partial u_1}{\partial x} \right)}_{=0} + 6c(c-1)u \frac{\partial u_1}{\partial x} \\
  &= 6c(c-1) u\frac{\partial u_1}{\partial x} \\
  &\ne 0
\end{aligned}
$$

であるので、線形でないことがわかる。この方程式は、 Korteweg-de Vries (KdV)方程式と呼ばれ、浅い水の波を表す重要な非線形方程式である。

## 解説

### 微分方程式とは

微分方程式とは、微分演算子が含まれるような方程式である。その中でも微分する独立変数が一種類であるようなものを **常微分方程式(ordinary differential equation)** 、独立変数が複数含まれるものを **偏微分方程式(partial differential equation)** と呼ぶ。これらの方程式を微分を含まない形に書き直すことが目的である。微分方程式を解く方法には長い歴史があり、様々な手法があるが、基本的に微分方程式は「解けたらラッキー」なのであり、一般的には解けるどころか解が存在するかどうかも非自明なものがほとんどである。

偏微分を常微分と区別するために$\partial$という記号を用いる。$\partial/\partial x$は、他の独立変数を定数だと思って$x$で微分することである。物理で扱う現象はほとんど空間と時間が関係している。さらに我々が住む世界は3次元であるから、物理的な現象はほとんど4つの独立変数$x,y,z,t$で記述される。したがって、基本的に物理で扱う微分方程式は偏微分方程式である。偏微分方程式も基本的には常微分方程式と同様に解けばよいが、いくつか注意事項がある。

まず、微分をひっくり返してはいけない。常微分においては

$$
  \frac{1}{\displaystyle \left( \frac{\mathrm{d} y}{\mathrm{d} x} \right)} = \frac{\mathrm{d} x}{\mathrm{d} y}
$$

であったが、偏微分は他の変数の依存性があるためにこうはならない。詳しくはヤコビアンについて調べること。
また、(本質的に同じことであるが)常微分においては

$$
  \frac{\mathrm{d} y}{\mathrm{d} x} \mathrm{d} x = \mathrm{d} y
$$

であったが、

$$
  \frac{\partial y}{\partial x} \partial x = \partial y
$$

などとしてはならない。これについても詳しくは全微分について調べること。

### 微分方程式の解法

微分方程式においては解の形を仮定して代入していく方法が良く取られる。代表的なものに **変数分離法** 及び **定数変化法** などがある。物理数学においては、とりあえずその二つを知っていれば良い。

変数分離法とは、解を異なる変数が積の形で書けると仮定して解く方法である。常微分方程式の場合、微分方程式が

$$
  \frac{\mathrm{d} y}{\mathrm{d} x} = X(x) Y(y)
$$

と書けるものを **変数分離型** と呼ぶ。ただし$X(x)$、$Y(y)$はそれぞれ$x$のみ、$y$のみを含む関数である。変数分離型の微分方程式は、$Y(y)$を左辺に移項して両辺$x$で積分すればよい。すなわち、

$$
\begin{aligned}
  \frac{1}{Y(y)}\frac{\mathrm{d} y}{\mathrm{d} x} &= X(x) \\
  \int \frac{\mathrm{d} y}{\mathrm{d} x} \mathrm{d} x \frac{1}{Y(y)}  &= \int \mathrm{d} x X(x) +C \\
  \int \mathrm{d} y \frac{1}{Y(y)}  &= \int \mathrm{d} x X(x) + C
\end{aligned}
$$

として解を得ることが出来る。$C$は積分定数である。このように積分定数を含む解を **一般解** と呼ぶ。一般解は微分方程式の解全体を表しており、微分の回数だけ積分定数を含む。さらに初期条件や境界条件を考えると積分定数の値が確定し、解が具体的に求まる。このようにして求まった解を **特殊解** 、もしくは **特解** と呼び、物理数学においては特解を求めるのが主な目的となる。

偏微分方程式においても変数分離法が存在する。関数$u$が二つの独立変数$x,t$に依存するとしよう。このとき、解の形を$u(x,t) = X(x)T(t)$の形に仮定して微分方程式に代入し、常微分方程式の固有値問題に帰着させる方法である。具体例を見たほうが早いと思うので、詳しくは解答を参照せよ。

定数変化法とは、

$$
  \frac{\mathrm{d} y}{\mathrm{d} x} + y = f(x)
$$

のような形をしているとき、まず$f(x) = 0$とおいて解を求め、積分定数$C$を$x$に依存するとしてもう一度代入して解を求める方法である。これも解答を参照せよ。

微分方程式の一般解は積分定数という任意定数を含む。しかし、物理で扱う問題では微分方程式のほかに条件がつく。たとえば熱伝導の問題を解く場合は、境界での温度を指定する必要があるだろう。物体の運動を扱う場合は、初期位置や初期速度を与える必要がある。これらの条件を **境界条件 (boundary condition)** 、境界条件を満たす解を求める問題を **境界値問題 (boundary value problem)** と呼ぶ。特に、$x=0$における値$y(0)$やその微分の値$y'(0)$を与える問題を初期値問題と呼ぶ。基本的には、まず一般解を求め、境界条件を満たすように積分定数を決めればよい。

### 線形性

微分方程式が一般には解くことが難しいことをすでに述べた。しかし、線形微分方程式は解くことが可能である。 **線形(linear)** であるとは、 **演算子 (operator)** $\mathcal L$と、 **被演算子(operand)** $x,y$の間に、$a$、$b$を定数として

$$
  {\mathcal L} (a x + by) = a {\mathcal L}x +b {\mathcal L}y
$$

が成り立つことである。たとえば、演算子を行列、被演算子をベクトルだと思えば線形性が成り立つ(行列が線形代数と呼ばれる所以である)。演算子として微分や積分、被演算子として関数だと思っても良い。

$y$が$x$にのみ依存するとする。微分方程式が$y$、その微分(何階でも良い)、さらに$x$の関数の線形結合のみを含む場合、その微分方程式を **線形微分方程式 (liner differential equation)** と呼ぶ(この微分方程式が線形性の定義を満たすことを確認せよ)。特に$x$の関数を含まないものを **同次方程式(homogeneous linear equation)** と呼ぶ。物理において線形微分方程式は非常に重要である。

同次方程式は、基本的に解を$\exp (\lambda x)$の形に仮定して解く。これは、 **指数関数が微分演算子の固有関数であるからである** 。**演算子 (operator)** と、 **固有関数 (eigen function)** あるいは**固有ベクトル (eigen vector)** について考えるのは、解析の問題を代数に落とすためである。この事実は今後何度も強調されるであろう。
